let hot = new Handsontable(container, {
    data: [],  // 初期データ
    colHeaders: ['プレイヤー名', '①', '②', '③', '備考'],
    rowHeaders: true,
    contextMenu: true,
    manualRowResize: true,
    manualColumnResize: true,
    stretchH: 'all',
    colWidths: [50, 30, 30, 30, 100],
    columns: [
        { readOnly: true },
        { editor: false },
        { editor: false },
        { editor: false },
        {}
    ],
    outsideClickDeselects: false,
    afterChange: function(changes, source) {
        if (source !== 'loadData') {  // 初期データロード時は保存しない
            saveTableToLocalStorage();
        }
    }
});

// テーブルのデータをlocalStorageに保存する関数
function saveTableToLocalStorage() {
    const tableData = hot.getData();  // テーブルのデータを取得
    localStorage.setItem('tableData', JSON.stringify(tableData));  // JSONに変換して保存
    console.log('テーブルデータが自動保存されましたにゃん');
}

// ページロード時にlocalStorageからデータを読み込む
function loadTableFromLocalStorage() {
    const savedData = localStorage.getItem('tableData');
    if (savedData) {
        hot.loadData(JSON.parse(savedData));  // 保存されたデータをテーブルに読み込む
    }
}

loadTableFromLocalStorage();  // ページ読み込み時にデータをロード
